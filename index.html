<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Chess</title>
    <link rel="stylesheet" href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css">
    <style>
        body { background: #1a1a2e; min-height: 100vh; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        h1 { color: white; margin: 0 0 15px 0; }
        .menu { display: flex; flex-direction: column; gap: 10px; }
        .menu button { padding: 15px 40px; font-size: 18px; background: #333; color: white; border: 2px solid #555; border-radius: 8px; cursor: pointer; }
        #game-container { display: none; width: 400px; max-width: 95vw; }
        #game-container.show { display: block; }
        #board { width: 100%; margin: 10px 0; }
        #status { color: #ccc; padding: 10px; text-align: center; }
        #backBtn { margin-top: 15px; padding: 10px 25px; background: #e94560; color: white; border: none; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Chess</h1>
    <div class="menu" id="menu">
        <button onclick="startGame('pvp')">vs Player</button>
        <button onclick="startGame('pvc')">vs Computer</button>
    </div>
    <div id="game-container">
        <div id="board"></div>
        <div id="status"></div>
        <button id="backBtn" onclick="showMenu()">Back</button>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
    <script src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"></script>
    <script>
        var board = null;
        var game = new Chess();
        var mode = 'pvp';
        
        var config = {
            draggable: true,
            position: 'start',
            pieceTheme: 'https://chessboardjs.com/img/chesspieces/wikipedia/{piece}.png',
            onDragStart: onDragStart,
            onDrop: onDrop,
            onSnapEnd: onSnapEnd
        };
        
        function startGame(selectedMode) {
            mode = selectedMode;
            game.reset();
            document.getElementById('menu').style.display = 'none';
            document.getElementById('game-container').classList.add('show');
            board = Chessboard('board', config);
            updateStatus();
        }
        
        function showMenu() {
            document.getElementById('game-container').classList.remove('show');
            document.getElementById('menu').style.display = 'flex';
            board = null;
        }
        
        function onDragStart(source, piece, position, orientation) {
            if (game.game_over()) return false;
            if (mode === 'pvp') {
                if ((game.turn() === 'w' && piece.search(/^b/) !== -1) || (game.turn() === 'b' && piece.search(/^w/) !== -1)) return false;
            } else {
                if (piece.search(/^b/) !== -1) return false;
            }
        }
        
        function onDrop(source, target) {
            var move = game.move({ from: source, to: target, promotion: 'q' });
            if (move === null) return 'snapback';
            board.position(game.fen());
            updateStatus();
            if (mode === 'pvc' && game.turn() === 'b') setTimeout(makeComputerMove, 300);
        }
        
        function makeComputerMove() {
            var moves = game.moves();
            if (game.game_over() || moves.length === 0) return;
            game.move(moves[Math.floor(Math.random() * moves.length)]);
            board.position(game.fen());
            updateStatus();
        }
        
        function onSnapEnd() { board.position(game.fen()); }
        
        function updateStatus() {
            var status = '';
            var turn = game.turn() === 'b' ? 'Black' : 'White';
            if (game.in_checkmate()) status = 'Game over, ' + turn + ' wins!';
            else if (game.in_draw()) status = 'Draw';
            else { status = turn + "'s turn"; if (game.in_check()) status += ' (Check!)'; }
            document.getElementById('status').textContent = status;
        }
    </script>
</body>
</html>
